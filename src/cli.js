#!/usr/bin/env node
import { Command } from 'commander';
import { PDFExporter } from './PDFExporter';
import path from 'path';
import fs from 'fs/promises';
const program = new Command();
program
    .name('markdown-pdf-export')
    .description('CLI tool to convert markdown files to PDF with image support')
    .version('1.0.0');
program
    .argument('<input>', 'Input markdown file path')
    .option('-o, --output <path>', 'Output PDF file path')
    .option('-v, --vault <path>', 'Obsidian vault path for resolving images', '/Users/jeroendezwart/2th Brain')
    .option('-f, --format <format>', 'Page format (a4|letter)', 'a4')
    .option('-m, --margin <number>', 'Page margin in mm', '10')
    .option('-w, --width <number>', 'Content width in pixels', '800')
    .option('-s, --scale <number>', 'Scale factor for quality', '2')
    .option('--no-images', 'Disable image embedding')
    .option('--verify', 'Generate verification images after PDF creation')
    .option('--debug', 'Enable debug logging')
    .action(async (input, options) => {
    try {
        // Validate input file
        const inputPath = path.resolve(input);
        const inputStats = await fs.stat(inputPath);
        if (!inputStats.isFile() || !input.endsWith('.md')) {
            console.error('Error: Input must be a markdown file (.md)');
            process.exit(1);
        }
        // Resolve output path
        const outputPath = options.output ||
            path.join(path.dirname(inputPath), `${path.basename(input, '.md')}.pdf`);
        console.log('üöÄ Starting PDF export...');
        console.log(`üìÅ Input: ${inputPath}`);
        console.log(`üìÑ Output: ${outputPath}`);
        console.log(`üóÇÔ∏è  Vault: ${options.vault}`);
        const exporter = new PDFExporter({
            vaultPath: options.vault,
            pageSize: options.format,
            margin: parseInt(options.margin),
            contentWidth: parseInt(options.width),
            scale: parseFloat(options.scale),
            includeImages: options.images !== false,
            debug: options.debug || false
        });
        await exporter.exportMarkdownToPDF(inputPath, outputPath);
        if (options.verify) {
            console.log('\nüîç Generating verification images...');
            await exporter.verifyPDF(outputPath);
        }
        console.log('‚úÖ PDF export completed successfully!');
    }
    catch (error) {
        console.error('‚ùå Export failed:', error.message);
        if (options.debug) {
            console.error(error.stack);
        }
        process.exit(1);
    }
});
program.parse();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2xpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDNUMsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUU3QixNQUFNLE9BQU8sR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO0FBRTlCLE9BQU87S0FDSixJQUFJLENBQUMscUJBQXFCLENBQUM7S0FDM0IsV0FBVyxDQUFDLDhEQUE4RCxDQUFDO0tBQzNFLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUVwQixPQUFPO0tBQ0osUUFBUSxDQUFDLFNBQVMsRUFBRSwwQkFBMEIsQ0FBQztLQUMvQyxNQUFNLENBQUMscUJBQXFCLEVBQUUsc0JBQXNCLENBQUM7S0FDckQsTUFBTSxDQUFDLG9CQUFvQixFQUFFLDBDQUEwQyxFQUFFLGdDQUFnQyxDQUFDO0tBQzFHLE1BQU0sQ0FBQyx1QkFBdUIsRUFBRSx5QkFBeUIsRUFBRSxJQUFJLENBQUM7S0FDaEUsTUFBTSxDQUFDLHVCQUF1QixFQUFFLG1CQUFtQixFQUFFLElBQUksQ0FBQztLQUMxRCxNQUFNLENBQUMsc0JBQXNCLEVBQUUseUJBQXlCLEVBQUUsS0FBSyxDQUFDO0tBQ2hFLE1BQU0sQ0FBQyxzQkFBc0IsRUFBRSwwQkFBMEIsRUFBRSxHQUFHLENBQUM7S0FDL0QsTUFBTSxDQUFDLGFBQWEsRUFBRSx5QkFBeUIsQ0FBQztLQUNoRCxNQUFNLENBQUMsVUFBVSxFQUFFLGlEQUFpRCxDQUFDO0tBQ3JFLE1BQU0sQ0FBQyxTQUFTLEVBQUUsc0JBQXNCLENBQUM7S0FDekMsTUFBTSxDQUFDLEtBQUssRUFBRSxLQUFhLEVBQUUsT0FBTyxFQUFFLEVBQUU7SUFDdkMsSUFBSSxDQUFDO1FBQ0gsc0JBQXNCO1FBQ3RCLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdEMsTUFBTSxVQUFVLEdBQUcsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzVDLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDbkQsT0FBTyxDQUFDLEtBQUssQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1lBQzVELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEIsQ0FBQztRQUVELHNCQUFzQjtRQUN0QixNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsTUFBTTtZQUMvQixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFM0UsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1FBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxTQUFTLEVBQUUsQ0FBQyxDQUFDO1FBQ3RDLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxVQUFVLEVBQUUsQ0FBQyxDQUFDO1FBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUU1QyxNQUFNLFFBQVEsR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUMvQixTQUFTLEVBQUUsT0FBTyxDQUFDLEtBQUs7WUFDeEIsUUFBUSxFQUFFLE9BQU8sQ0FBQyxNQUFNO1lBQ3hCLE1BQU0sRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztZQUNoQyxZQUFZLEVBQUUsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7WUFDckMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDO1lBQ2hDLGFBQWEsRUFBRSxPQUFPLENBQUMsTUFBTSxLQUFLLEtBQUs7WUFDdkMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLLElBQUksS0FBSztTQUM5QixDQUFDLENBQUM7UUFFSCxNQUFNLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFFMUQsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sUUFBUSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN2QyxDQUFDO1FBRUQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO0lBRXRELENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDakQsSUFBSSxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDbEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDN0IsQ0FBQztRQUNELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbEIsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUwsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiIyEvdXNyL2Jpbi9lbnYgbm9kZVxuXG5pbXBvcnQgeyBDb21tYW5kIH0gZnJvbSAnY29tbWFuZGVyJztcbmltcG9ydCB7IFBERkV4cG9ydGVyIH0gZnJvbSAnLi9QREZFeHBvcnRlcic7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5cbmNvbnN0IHByb2dyYW0gPSBuZXcgQ29tbWFuZCgpO1xuXG5wcm9ncmFtXG4gIC5uYW1lKCdtYXJrZG93bi1wZGYtZXhwb3J0JylcbiAgLmRlc2NyaXB0aW9uKCdDTEkgdG9vbCB0byBjb252ZXJ0IG1hcmtkb3duIGZpbGVzIHRvIFBERiB3aXRoIGltYWdlIHN1cHBvcnQnKVxuICAudmVyc2lvbignMS4wLjAnKTtcblxucHJvZ3JhbVxuICAuYXJndW1lbnQoJzxpbnB1dD4nLCAnSW5wdXQgbWFya2Rvd24gZmlsZSBwYXRoJylcbiAgLm9wdGlvbignLW8sIC0tb3V0cHV0IDxwYXRoPicsICdPdXRwdXQgUERGIGZpbGUgcGF0aCcpXG4gIC5vcHRpb24oJy12LCAtLXZhdWx0IDxwYXRoPicsICdPYnNpZGlhbiB2YXVsdCBwYXRoIGZvciByZXNvbHZpbmcgaW1hZ2VzJywgJy9Vc2Vycy9qZXJvZW5kZXp3YXJ0LzJ0aCBCcmFpbicpXG4gIC5vcHRpb24oJy1mLCAtLWZvcm1hdCA8Zm9ybWF0PicsICdQYWdlIGZvcm1hdCAoYTR8bGV0dGVyKScsICdhNCcpXG4gIC5vcHRpb24oJy1tLCAtLW1hcmdpbiA8bnVtYmVyPicsICdQYWdlIG1hcmdpbiBpbiBtbScsICcxMCcpXG4gIC5vcHRpb24oJy13LCAtLXdpZHRoIDxudW1iZXI+JywgJ0NvbnRlbnQgd2lkdGggaW4gcGl4ZWxzJywgJzgwMCcpXG4gIC5vcHRpb24oJy1zLCAtLXNjYWxlIDxudW1iZXI+JywgJ1NjYWxlIGZhY3RvciBmb3IgcXVhbGl0eScsICcyJylcbiAgLm9wdGlvbignLS1uby1pbWFnZXMnLCAnRGlzYWJsZSBpbWFnZSBlbWJlZGRpbmcnKVxuICAub3B0aW9uKCctLXZlcmlmeScsICdHZW5lcmF0ZSB2ZXJpZmljYXRpb24gaW1hZ2VzIGFmdGVyIFBERiBjcmVhdGlvbicpXG4gIC5vcHRpb24oJy0tZGVidWcnLCAnRW5hYmxlIGRlYnVnIGxvZ2dpbmcnKVxuICAuYWN0aW9uKGFzeW5jIChpbnB1dDogc3RyaW5nLCBvcHRpb25zKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFZhbGlkYXRlIGlucHV0IGZpbGVcbiAgICAgIGNvbnN0IGlucHV0UGF0aCA9IHBhdGgucmVzb2x2ZShpbnB1dCk7XG4gICAgICBjb25zdCBpbnB1dFN0YXRzID0gYXdhaXQgZnMuc3RhdChpbnB1dFBhdGgpO1xuICAgICAgaWYgKCFpbnB1dFN0YXRzLmlzRmlsZSgpIHx8ICFpbnB1dC5lbmRzV2l0aCgnLm1kJykpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6IElucHV0IG11c3QgYmUgYSBtYXJrZG93biBmaWxlICgubWQpJyk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVzb2x2ZSBvdXRwdXQgcGF0aFxuICAgICAgY29uc3Qgb3V0cHV0UGF0aCA9IG9wdGlvbnMub3V0cHV0IHx8XG4gICAgICAgIHBhdGguam9pbihwYXRoLmRpcm5hbWUoaW5wdXRQYXRoKSwgYCR7cGF0aC5iYXNlbmFtZShpbnB1dCwgJy5tZCcpfS5wZGZgKTtcblxuICAgICAgY29uc29sZS5sb2coJ/CfmoAgU3RhcnRpbmcgUERGIGV4cG9ydC4uLicpO1xuICAgICAgY29uc29sZS5sb2coYPCfk4EgSW5wdXQ6ICR7aW5wdXRQYXRofWApO1xuICAgICAgY29uc29sZS5sb2coYPCfk4QgT3V0cHV0OiAke291dHB1dFBhdGh9YCk7XG4gICAgICBjb25zb2xlLmxvZyhg8J+Xgu+4jyAgVmF1bHQ6ICR7b3B0aW9ucy52YXVsdH1gKTtcblxuICAgICAgY29uc3QgZXhwb3J0ZXIgPSBuZXcgUERGRXhwb3J0ZXIoe1xuICAgICAgICB2YXVsdFBhdGg6IG9wdGlvbnMudmF1bHQsXG4gICAgICAgIHBhZ2VTaXplOiBvcHRpb25zLmZvcm1hdCxcbiAgICAgICAgbWFyZ2luOiBwYXJzZUludChvcHRpb25zLm1hcmdpbiksXG4gICAgICAgIGNvbnRlbnRXaWR0aDogcGFyc2VJbnQob3B0aW9ucy53aWR0aCksXG4gICAgICAgIHNjYWxlOiBwYXJzZUZsb2F0KG9wdGlvbnMuc2NhbGUpLFxuICAgICAgICBpbmNsdWRlSW1hZ2VzOiBvcHRpb25zLmltYWdlcyAhPT0gZmFsc2UsXG4gICAgICAgIGRlYnVnOiBvcHRpb25zLmRlYnVnIHx8IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwb3J0ZXIuZXhwb3J0TWFya2Rvd25Ub1BERihpbnB1dFBhdGgsIG91dHB1dFBhdGgpO1xuXG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1xcbvCflI0gR2VuZXJhdGluZyB2ZXJpZmljYXRpb24gaW1hZ2VzLi4uJyk7XG4gICAgICAgIGF3YWl0IGV4cG9ydGVyLnZlcmlmeVBERihvdXRwdXRQYXRoKTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ+KchSBQREYgZXhwb3J0IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkhJyk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEV4cG9ydCBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgICBpZiAob3B0aW9ucy5kZWJ1Zykge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yLnN0YWNrKTtcbiAgICAgIH1cbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG4gIH0pO1xuXG5wcm9ncmFtLnBhcnNlKCk7Il19